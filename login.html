<html>
<head>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <link rel="stylesheet" href="https://res.wx.qq.com/open/libs/weui/2.3.0/weui.min.css"/>
    <style type="text/css">
    body{
        font-size: large;
    }
    button{
        width: 100%;
        font-size: large;
    }
    .weui-btn_mini{
        font-size: 50px;
    }
    </style>
</head>
<body style="padding: 20ex;">
    <div class="page" style="width: 100%;">
        <div class="page__hd" style="text-align: center;border: 20ex;">
            <h1 class="page__title">Get Code via CorpId, AgentId, UserId</h1>
        </div>
        <div class="page__bd" style="width: 100%;text-align: center;">
            code:
            <input type="text" class="weui-input" style="padding: 20ex;" id="code">
            error:
            <input type="text" class="weui-input" style="padding: 20ex;" id="uname">
            <div id="show"></div>
            <div class="button-sp-area">
                <button onclick="sendUrl()" style="width:100%;border: 20ex;" class="weui-btn weui-btn_mini weui-btn_primary wechat-ui-font-size">Get Code</button>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function getUrlVars() {
            var vars = [],
                hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }
        var code = getUrlVars()["code"];
        var token  = 'X0CpFvBgcVG-TsjOek6aA_135alDI7KoQWvyreAR9qMz9rv5hck4l3UCBJofGXv95rfps5GCjJoz8v3gAFkJENLdkw0ghthsXGBTItk7VhBx8zKJTB1llQYrMMl9ElHI4RJaw4v9-zNA-X0mLzoJpnnRJtOr2Tdkq7xOULV2Yat7VRPn71TzuD9_gU7uG6NLSDgF-7UMsbJqYvKhQsC45VAhUKKDtau8FzaiPSoDw6Y';
        var url = 'http://202.106.175.109:443//cgi-bin/user/getuserinfo?access_token='+token+'&code='+code;
        function sendUrl(){
            $('#uname').val(code);
            $.ajax({
            url: 'http://117.78.7.87:8081/wework/cgi-bin/user/getuserinfo?access_token='+token+'&code='+code,
            method: 'GET',
            success: function(data){
                var jsn=JSON.stringify(data);
                $("#uname").val('User ID:'+data.UserId+'--'+'Device ID:'+data.DeviceId);
            },
            error: function(jqXHR, textStatus, errorThrown){
                $('#uname').val(jqXHR.status+'-jqhr-'+jqXHR.responseText+'-status-'+errorThrown);
                $('#code').val(code);
            }
            });
        }
        function setVal(){
            $('#uname').val(data);
        }
        </script>
</body>
</html>